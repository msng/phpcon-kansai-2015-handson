{"version":3,"sources":["single-button-action.coffee"],"names":[],"mappings":"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","file":"single-button-action.js","sourceRoot":"/source/","sourcesContent":["###\nクリック1発でPOSTやPUTなどのリクエストを\n\nAttributes:\ndata-url required\ndata-method optional\ndata-confirm optional\n\n<button data-url=\"/path/to/action\" data-method=\"DELETE\" data-confirm=\"Are you sure?\">Delete</button>\n\n$buttons.singleButtonAction({\n    // optional\n    prepare: function() {\n        return { ... extra params to send };\n    }\n});\n###\n$.fn.singleButtonAction = (config)->\n    $(this).on 'click', (event)->\n        event.preventDefault()\n\n        exec = =>\n            url = $(this).data 'url'\n            method = $(this).data 'method' ? 'post'\n            data = if config?.prepare? then config.prepare.call this else null\n\n            form = $('<form action=\"' + url + '\">')\n            switch method.toLowerCase()\n                when 'get'\n                    form.attr 'method', 'get'\n                when 'post'\n                    form.attr 'method', 'post'\n                else\n                    form.attr 'method', 'post'\n                    form.append(\n                            $('<input type=\"hidden\" name=\"_method\">').val method.toUpperCase()\n                    )\n            if data?\n                for k, v in data\n                    form.append(\n                            $('<input type=\"hidden\">').attr('name', k).val v\n                    )\n            form.submit()\n\n        if $(this).data 'confirm'\n            bootbox.confirm ($(this).data 'confirm'), (ok)->\n                if ok\n                    exec()\n        else\n            exec()\n\n###\nクリック1発でGET以外のリクエストを\n\nAttributes:\ndata-url required\ndata-method optional\ndata-confirm optional\n\n<button data-url=\"/path/to/action\" data-method=\"DELETE\" data-confirm=\"Are you sure?\">Delete</button>\n\n$buttons.singleButtonAjaxAction({\n    // optional\n    prepare: function() {\n        return { ... extra params to send };\n    },\n    // optional\n    done: function(data) {\n        // succeeded handler\n    },\n    // optional\n    fail: function() {\n        // failed handler\n    }\n});\n###\n$.fn.singleButtonAjaxAction = (config)->\n    $(this).on 'click', (event)->\n        event.preventDefault()\n\n        exec = =>\n            url = $(this).data 'url'\n            method = $(this).data 'method'\n            data = if config?.prepare? then config.prepare.call this else null\n\n            context = {}\n            context.type = method ? 'POST'\n            if data?\n                context.data = data\n\n            $.ajax url, context\n            .done (data)=>\n                    if config?.done then config.done.call this, data\n            .fail =>\n                    if config?.fail then config.fail.call()\n\n        if $(this).data 'confirm'\n            bootbox.confirm ($(this).data 'confirm'), (ok)->\n                if ok\n                    exec()\n        else\n            exec()"]}